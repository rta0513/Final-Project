# Imports the subprocess package to allow the use of command line tools
import subprocess

# Defines the NMAP funtion to be choosen later by user
def nmap_fun():
    # Informs user of choosen funtion
    print("You have choosen the nmap function")
    # Requests target to scan
    nmap_targ = input("Please define the target you wish to scan: ")
    # Confirms target to scan
    print("The target you have choosen is: ", nmap_targ)
    # Requests scan type
    nmap_type = input("Please choose the type of scan you wish to perform:\n"
                      "1)TCP Scan\n"
                      "2)UDP Scan\n"
                      "3)Comprehensive Scan\n"
                      "4)Ping\n"
                      "5)Traceroute\n"
                      "Enter Here: ")
    # Series of if statements decided by the user's previous input
    if nmap_type == "1":
        # Informs user of choosen scan type and target
        print("TCP Scan has been choosen against the target: ", nmap_targ)
        print("Please wait...")
        # The command being ran with choosen option
        # This runs a TCP scan against the 1000 most common ports by default
        nmap_com = ["nmap", "-sS", nmap_targ]
        # The results of command being stored within variable
        nmap_res = subprocess.run(nmap_com, capture_output=True, text=True)
        # Prints the results of command
        print("Results:\n", nmap_res.stdout)
    elif nmap_type == "2":
        # Informs user of choosen scan type and target
        print("UDP scan has been chosen against the target: ", nmap_targ)
        print("Please wait...")
        # The command being ran with choosen option
        # This runs a UDP scan against the 1000 most common ports by default
        nmap_com = ["nmap", "-sU", nmap_targ]
        # The results of command being stored within variable
        nmap_res = subprocess.run(nmap_com, capture_output=True, text=True)
        # Prints the results of command
        print("Results:\n", nmap_res.stdout)
    elif nmap_type == "3":
        # Informs user of choosen scan type and target
        print("Comprehensive scan has been chosen against the target: ", nmap_targ)
        print("Please wait...")
        # The command being ran with choosen option
        # This runs TCP scan, UDP scan, OS detection, version detection
        nmap_com = ["nmap", "-sS", "-sU", "-A", "-sV", nmap_targ]
        # The results of command being stored within variable
        nmap_res = subprocess.run(nmap_com, capture_output=True, text=True)
        # Prints the results of command
        print("Results:\n", nmap_res.stdout)
    elif nmap_type == "4":
        # Informs user of choosen scan type and target
        print("Ping has been chosen against the target: ", nmap_targ)
        print("Please wait...")
        # The command being ran with choosen option
        # This runs a command similar to ping
        nmap_com = ["nmap", "-PE", nmap_targ]
        # The results of command being stored within variable
        nmap_res = subprocess.run(nmap_com, capture_output=True, text=True)
        # Prints the results of command
        print("Results:\n", nmap_res.stdout)
    elif nmap_type == "5":
        # Informs user of choosen scan type and target
        print("Traceroute has been chosen against the target: ", nmap_targ)
        print("Please wait...")
        # The command being ran with choosen option
        # This runs a command similar to traceroute
        nmap_com = ["nmap", "-PE", nmap_targ]
        # The results of command being stored within variable
        nmap_res = subprocess.run(nmap_com, capture_output=True, text=True)
        # Prints the results of command
        print("Results:\n", nmap_res.stdout)
    else:
        # Occurs when invalid option is choosen
        print("Invalid Option")
